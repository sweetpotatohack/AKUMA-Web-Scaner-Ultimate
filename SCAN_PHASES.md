# üî• AKUMA Web Scanner - –≠—Ç–∞–ø—ã —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

## –û–±–∑–æ—Ä —ç—Ç–∞–ø–æ–≤ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

AKUMA Web Scanner –∏—Å–ø–æ–ª—å–∑—É–µ—Ç 5-—ç—Ç–∞–ø–Ω—É—é –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—é —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ –ø–µ–Ω—Ç–µ—Å—Ç–∏–Ω–≥–∞:

### 1. **Discovery (–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ) - ~15 —Å–µ–∫—É–Ω–¥**
–ë–∞–∑–æ–≤–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ü–µ–ª–µ–π.

**–í—ã–ø–æ–ª–Ω—è–µ–º—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:**
- Resolving DNS - –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ DNS –∏–º–µ–Ω —Ü–µ–ª–µ–π
- Checking connectivity - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ö–æ—Å—Ç–æ–≤  
- Detecting web server - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞

**–≠–º—É–ª–∏—Ä—É–µ–º—ã–µ –∫–æ–º–∞–Ω–¥—ã:**
```bash
nslookup example.com
dig example.com
ping -c 3 example.com
```

---

### 2. **Port Scan (–ü–æ–ª–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—Ç–æ–≤) - ~20 —Å–µ–∫—É–Ω–¥**
–ü–æ–ª–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–æ—Ä—Ç–æ–≤ —Å –≤—ã—Å–æ–∫–æ–π —Å–∫–æ—Ä–æ—Å—Ç—å—é.

**–û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞:**
```bash
nmap -A -v -p- --min-rate 5000 -oN nmap_result example.com
```

**–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤:**
```bash
# –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ—Ä—Ç–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç ip:port
grep "Ports:" "$LOG_DIR/nmap_result.gnmap" | awk -F"[ /]" '{
    split($0, a, "Ports: "); 
    split(a[2], ports, ", "); 
    for (i in ports) { 
        split(ports[i], p, "/"); 
        if (p[1] ~ /^[0-9]+$/ && p[1] <= 65535) {
            print $2":"p[1]; 
        }
    }
}' > "$LOG_DIR/open_ports.txt"
```

**–§–ª–∞–≥–∏ nmap:**
- `-A` - –ê–≥—Ä–µ—Å—Å–∏–≤–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (OS detection, version detection, script scanning, traceroute)
- `-v` - Verbose —Ä–µ–∂–∏–º
- `-p-` - –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–æ—Ä—Ç–æ–≤ (1-65535)
- `--min-rate 5000` - –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø–∞–∫–µ—Ç–æ–≤
- `-oN` - –ù–æ—Ä–º–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥ –≤ —Ñ–∞–π–ª

---

### 3. **Web Probe (–í–µ–±-–∑–æ–Ω–¥–∏—Ä–æ–≤–∞–Ω–∏–µ) - ~25 —Å–µ–∫—É–Ω–¥**
–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –ø–æ—Ä—Ç–æ–≤ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –≤–µ–±-—Å–µ—Ä–≤–∏—Å–æ–≤ –∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ CMS.

**–ö–æ–º–∞–Ω–¥—ã:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ–±-—Å–µ—Ä–≤–∏—Å–æ–≤ –Ω–∞ –≤—Å–µ—Ö –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ—Ä—Ç–∞—Ö
httpx -l open_ports.txt -title -tech-detect -status-code -o httpx_result.txt

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ CMS –∏ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π
whatweb example.com
```

**–í—ã–ø–æ–ª–Ω—è–µ–º—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:**
- HTTP/HTTPS detection - –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ HTTP/HTTPS —Å–µ—Ä–≤–∏—Å–æ–≤ –Ω–∞ –≤—Å–µ—Ö –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ—Ä—Ç–∞—Ö
- Crawling web pages - –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü
- Technology detection - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –∏ CMS
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –≤–µ–±-—Å–µ—Ä–≤–∏—Å–æ–≤ –≤ httpx_result.txt

---

### 4. **Vulnerability Scan (–°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π) - ~30 —Å–µ–∫—É–Ω–¥**
–ë–∞–∑–æ–≤–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –∏ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö CMS.

#### –ë–∞–∑–æ–≤–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:
```bash
# Nuclei —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –≤–µ–±-—Å–µ—Ä–≤–∏—Å–æ–≤
nuclei -l httpx_result.txt -o nuclei_results.txt
```

#### –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ Bitrix (–µ—Å–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω):

**1. –ü–æ–ª—É—á–µ–Ω–∏–µ Webhook URL:**
```bash
# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è Webhook URL
get_webhook_url() {
    if command -v curl &>/dev/null && command -v jq &>/dev/null; then
        response=$(curl -s -X POST "https://webhook.site/token" 2>/dev/null)
        token=$(echo "$response" | jq -r '.uuid' 2>/dev/null)
        
        if [ -n "$token" ]; then
            echo "https://webhook.site/$token"
            return
        fi
    fi
}
```

**2. –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–∫–∞–Ω–µ—Ä Bitrix:**
```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∑–∞–ø—É—Å–∫ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–∫–∞–Ω–µ—Ä–∞
git clone https://github.com/k1rurk/check_bitrix && cd check_bitrix
python3 test_bitrix.py -t https://target scan -s $(get_webhook_url)
```

**3. Nuclei —Ç–µ–º–ø–ª–µ–π—Ç—ã –¥–ª—è Bitrix:**
```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Ç–µ–º–ø–ª–µ–π—Ç–æ–≤
git clone https://github.com/jhonnybonny/nuclei-templates-bitrix
nuclei -l httpx_result.txt -t nuclei-templates-bitrix
```

**4. Fuzzing Bitrix:**
```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–æ–≤–∞—Ä—è –¥–ª—è —Ñ–∞–∑–∑–∏–Ω–≥–∞
git clone https://github.com/jivoi/pentest
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ dicc.txt –¥–ª—è —Ñ–∞–∑–∑–∏–Ω–≥–∞ Bitrix –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
dirsearch -u https://target -w pentest/wordlists/dicc.txt
```

#### –°–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ WordPress (–µ—Å–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω):
```bash
# WPScan —Å –ø–æ–ª–Ω—ã–º –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ–º
wpscan --url target --enumerate ap,at,cb,dbe --format json --output wpscan_results.json
```

---

### 5. **Deep Analysis (–ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑) - ~10 —Å–µ–∫—É–Ω–¥**
–§–∏–Ω–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤.

**–í—ã–ø–æ–ª–Ω—è–µ–º—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:**
- Analyzing results - –ê–Ω–∞–ª–∏–∑ –≤—Å–µ—Ö —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- Generating report - –°–æ–∑–¥–∞–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞
- Finalizing scan - –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –æ—á–∏—Å—Ç–∫–∞

**–≠–º—É–ª–∏—Ä—É–µ–º—ã–µ –∫–æ–º–∞–Ω–¥—ã:**
```bash
# –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
nmap --script vuln target
gobuster dir -u http://target -w /wordlists/common.txt
```

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤—ã—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

### –õ–æ–≥–∏ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `/tmp/akuma_scan_{scan_id}/`:

- `nmap_result_{target}` - –ü–æ–ª–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã nmap —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- `open_ports.txt` - –°–ø–∏—Å–æ–∫ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ—Ä—Ç–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–µ ip:port
- `httpx_result.txt` - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–µ–±-—Å–µ—Ä–≤–∏—Å–æ–≤
- `nuclei_results.txt` - –ù–∞–π–¥–µ–Ω–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ nuclei
- `check_bitrix/` - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è Bitrix
- `nuclei-templates-bitrix/` - –¢–µ–º–ø–ª–µ–π—Ç—ã –¥–ª—è Bitrix
- `pentest/wordlists/dicc.txt` - –°–ª–æ–≤–∞—Ä—å –¥–ª—è —Ñ–∞–∑–∑–∏–Ω–≥–∞ Bitrix
- `wpscan_results.json` - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è WordPress

---

## –¢–∏–ø—ã –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ–º—ã—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π

- **Critical**: SQL Injection
- **High**: Cross-Site Scripting (XSS), Directory Traversal
- **Medium**: CSRF, Missing Security Headers
- **Low**: Information Disclosure, Insecure Configurations

---

## –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### CMS Detection
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:
- **Bitrix**: –ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –≤–∫–ª—é—á–∞—è check_bitrix, —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ nuclei —Ç–µ–º–ø–ª–µ–π—Ç—ã –∏ —Å–ª–æ–≤–∞—Ä–∏ –¥–ª—è —Ñ–∞–∑–∑–∏–Ω–≥–∞
- **WordPress**: WPScan —Å –ø–æ–ª–Ω—ã–º –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ–º –ø–ª–∞–≥–∏–Ω–æ–≤, —Ç–µ–º –∏ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
- **Joomla**: –ë–∞–∑–æ–≤–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ nuclei

### Real-time Logging
–í—Å–µ —ç—Ç–∞–ø—ã —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ –∏ –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑:
- WebSocket –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ `/ws/scan/{scan_id}`
- REST API endpoint –¥–ª—è –ª–æ–≥–æ–≤
- –î–µ—Ç–∞–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã –≤ HTML —Ñ–æ—Ä–º–∞—Ç–µ

### Webhook Integration
–î–ª—è Bitrix —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞–µ—Ç—Å—è webhook URL –æ—Ç webhook.site –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ RCE —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π.
